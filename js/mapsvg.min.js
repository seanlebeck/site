// mapSVG v5.5.6 - March 27 2013
// http://codecanyon.net/user/Yatek/portfolio?ref=Yatek

(function (e) {
var initmerge = {}; 
var merged = {}; 
var listObjectsstate = [];
var listObjectscounty = [];


    var n = {}, i = 0,
        s = navigator.userAgent.toLowerCase();
    var o = document.getElementsByTagName("script");
    var u = o[o.length - 1].src.split("/");
    u.pop();
    var a = u.join("/") + "/";
    u.pop();
    var f = u.join("/") + "/";
    var l = s.indexOf("ipad") > -1 || s.indexOf("iphone") > -1 || s.indexOf("ipod") > -1 || s.indexOf("android") > -1;
    var c = {};
    c.ie = s.indexOf("msie") > -1 ? {} : false;
    if (c.ie) c.ie.old = navigator.userAgent.match(/MSIE [6-8]/) !== null;
    c.firefox = s.indexOf("firefox") > -1;
    if (!String.prototype.trim) {
        String.prototype.trim = function () {
            return this.replace(/^\s+|\s+$/g, "")
        }
    }
    if (l) {
        var h = function (e) {
            return e.touches[0] ? {
                x: e.touches[0].pageX,
                y: e.touches[0].pageY
            } : {
                x: e.changedTouches[0].pageX,
                y: e.changedTouches[0].pageY
            }
        }
    } else {
        var h = function (t) {
            return {
                x: t.clientX + e(window).scrollLeft(),
                y: t.clientY + e(window).scrollTop()
            }
        }
    }
    var p = [128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 4294967296, 8589934592, 17179869184, 34359738368, 68719476736, 137438953472];
    var d = [.7111111111111111, 1.4222222222222223, 2.8444444444444446, 5.688888888888889, 11.377777777777778, 22.755555555555556, 45.51111111111111, 91.02222222222223, 182.04444444444445, 364.0888888888889, 728.1777777777778, 1456.3555555555556, 2912.711111111111, 5825.422222222222, 11650.844444444445, 23301.68888888889, 46603.37777777778, 93206.75555555556, 186413.51111111112, 372827.02222222224, 745654.0444444445, 1491308.088888889, 2982616.177777778, 5965232.355555556, 11930464.711111112, 23860929.422222223, 47721858.844444446, 95443717.68888889, 190887435.37777779, 381774870.75555557, 763549741.5111111];
    var v = [40.74366543152521, 81.48733086305042, 162.97466172610083, 325.94932345220167, 651.8986469044033, 1303.7972938088067, 2607.5945876176133, 5215.189175235227, 10430.378350470453, 20860.756700940907, 41721.51340188181, 83443.02680376363, 166886.05360752725, 333772.1072150545, 667544.214430109, 1335088.428860218, 2670176.857720436, 5340353.715440872, 10680707.430881744, 21361414.86176349, 42722829.72352698, 85445659.44705395, 170891318.8941079, 341782637.7882158, 683565275.5764316, 1367130551.1528633, 2734261102.3057265, 5468522204.611453, 10937044409.222906, 21874088818.445812, 43748177636.891624];
    var g = {
        keepSourceStyles: false,
        loadingText: "Loading map...",
        colors: {
            background: "#eeeeee",
            selected: 5,
            hover: 2
        },
        regions: {},
        viewBox: [],
        cursor: "default",
        scale: 1,
        tooltipsMode: "hover",
        tooltips: {
            show: "hover",
            mode: "names"
        },
        onClick: null,
        mouseOver: null,
        mouseOut: null,
        disableAll: false,
        hideAll: false,
        marks: null,
        hover_mode: "brightness",
        selected_mode: "brightness",
        hover_brightness: 1,
        selected_brightness: 5,
        pan: false,
        panLimit: true,
        panBackground: false,
        zoom: false,
        popover: {
            width: "auto",
            height: "auto"
        },
        buttons: true,
        zoomLimit: [0, 5],
        zoomDelta: 1.2,
        zoomButtons: {
            show: true,
            location: "right"
        },
        multiSelect: true
    };
    var y = {
        attrs: {
            cursor: "pointer",
            src: f + ""
        }
    };
    var b = function (s, o) {
        var u;
        this.methods = {
            destroy: function () {
                delete n[u.$map.attr("id")];
                u.$map.empty();
                return a
            },
            getData: function () {
                return u
            },
            getScale: function () {
                var e = u.svgDefault.width / u.svgDefault.height;
                var t = u.options.width / u.options.height;
                var n, r;
                var i = u.options.responsive ? [u.$map.width(), u.$map.height()] : [u.options.width, u.options.height];
                if (t < e) {
                    n = u.svgDefault.width / u.svgDefault.viewBox[2];
                    r = i[0] / u.viewBox[2]
                } else {
                    n = u.svgDefault.height / u.svgDefault.viewBox[3];
                    r = i[1] / u.viewBox[3]
                }
                return 1 - (n - r)
            },
            fluidResize: function (e, t) {
                if (!e || !t) {
                    e = u.$map.width();
                    t = u.$map.height()
                }
                u.R.setSize(e, t);
                u.scale = a.getScale();
                a.marksAdjustPosition()
            },
            getViewBox: function () {
                return u.viewBox
            },
            setViewBox: function (e) {
                if (typeof e == "string") {
                    var t = u.ref[e].getBBox();
                    u.viewBox = [t.x - 5, t.y - 5, t.width + 10, t.height + 10];
                    var n = true
                } else {
                    var r = e && e.length == 4 ? e : u.svgDefault.viewBox;
                    var n = parseInt(r[2]) != u.viewBox[2] || parseInt(r[3]) != u.viewBox[3];
                    u.viewBox = [parseFloat(r[0]), parseFloat(r[1]), parseFloat(r[2]), parseFloat(r[3])]
                }
                u.R.setViewBox(u.viewBox[0], u.viewBox[1], u.viewBox[2], u.viewBox[3], true);
                if (n) {
                    u.scale = a.getScale();
                    a.marksAdjustPosition();
                    if (c.ie && !c.ie.old || c.firefox) {
                        a.mapAdjustStrokes()
                    }
                }
                return true
            },
            viewBoxSetBySize: function (t, n) {
                u._viewBox = a.viewBoxGetBySize(t, n);
                u.viewBox = e.extend([], u._viewBox);
                u.scale = a.getScale();
                u.R.setViewBox(u.viewBox[0], u.viewBox[1], u.viewBox[2], u.viewBox[3], true);
                a.marksAdjustPosition();
                return u.viewBox
            },
            viewBoxGetBySize: function (t, n) {
                var r = t / n;
                var i = u.svgDefault.viewBox[2] / u.svgDefault.viewBox[3];
                var s = e.extend([], u.svgDefault.viewBox);
                if (r != i) {
                    s[2] = t * u.svgDefault.viewBox[2] / u.svgDefault.width;
                    s[3] = n * u.svgDefault.viewBox[3] / u.svgDefault.height
                }
                return s
            },
            viewBoxReset: function () {
                a.setViewBox()
            },
            mapAdjustStrokes: function () {
                e.each(u.ref, function (e, t) {
                    if (t.default_attr["stroke-width"]) t.attr({
                        "stroke-width": t.default_attr["stroke-width"] / u.scale
                    })
                })
            },
            zoomIn: function () {
                a.zoom(1)
            },
            zoomOut: function () {
                a.zoom(-1)
            },
            touchZoomStart: function (e) {
                touchZoomStart = u._scale;
                u.scale = u.scale * zoom_k;
                zoom = u._scale;
                u._scale = u._scale * zoom_k;
                var t = u.viewBox[2];
                var n = u.viewBox[3];
                var r = [];
                r[2] = u._viewBox[2] / u._scale;
                r[3] = u._viewBox[3] / u._scale;
                r[0] = u.viewBox[0] + (t - r[2]) / 2;
                r[1] = viewBox[1] + (n - r[3]) / 2;
                a.setViewBox(r, true)
            },
            touchZoomMove: function () {},
            touchZoomEnd: function () {},
            zoom: function (e, t) {
                var n = u.viewBox[2];
                var r = u.viewBox[3];
                var i = [];
                if (!t) {
                    var s = e > 0 ? 1 : -1;
                    u._zoomLevel = u.zoomLevel;
                    u._zoomLevel += s;
                    if (u._zoomLevel > u.options.zoomLimit[1] || u._zoomLevel < u.options.zoomLimit[0]) return false;
                    u.zoomLevel = u._zoomLevel;
                    var o = s * u.options.zoomDelta;
                    if (o < 1) o = -1 / o;
                    u._scale = u._scale * o;
                    i[2] = u._viewBox[2] / u._scale;
                    i[3] = u._viewBox[3] / u._scale
                } else {
                    u._scale = t;
                    i[2] = u.touchZoomStartViewBox[2] / u._scale;
                    i[3] = u.touchZoomStartViewBox[3] / u._scale
                }
                i[0] = u.viewBox[0] + (n - i[2]) / 2;
                i[1] = u.viewBox[1] + (r - i[3]) / 2;
                a.setViewBox(i, true)
            },
            markUpdate: function (e, t) {
                if (t.attrs["src"] == "") delete t.attrs["src"];
                if (t.attrs["href"] == "") delete t.attrs["href"];
                var n = new Image;
                n.onload = function () {
                    t.data.width = this.width;
                    t.data.height = this.height;
                    t.attrs.width = parseFloat(t.data.width / u.scale).toFixed(2);
                    t.attrs.height = parseFloat(t.data.height / u.scale).toFixed(2);
                    if (o.editMode && t.attrs.href) {
                        e.data("href", t.attrs.href);
                        delete t.attrs.href
                    } else if (o.editMode && !t.attrs.href) {
                        e.removeData("href")
                    }
                    e.data(t.data);
                    e.attr(t.attrs)
                };
                n.src = t.attrs.src
            },
            markDelete: function (e) {
                e.remove()
            },
            markAdd: function (t, n) {
                var r = e.extend(true, {}, y, t);
                if (r.width && r.height) {
                    return a.markAddFinalStep(r, n)
                } else {
                    var i = new Image;
                    i.onload = function () {
                        r.width = this.width;
                        r.height = this.height;
                        return a.markAddFinalStep(r, n)
                    };
                    i.src = r.attrs.src
                }
            },
            markAddFinalStep: function (t, n) {
                var r = e.extend(true, {}, t.attrs);
                var i = parseFloat(t.width / u.scale).toFixed(2);
                var s = parseFloat(t.height / u.scale).toFixed(2);
                var o = t.xy ? t.xy : t.attrs.x ? [t.attrs.x, t.attrs.y] : t.c ? a.ll2px(t) : false;
                if (!o) return false;
                if (n) {
                    o[0] = o[0] / u.scale - t.width / (2 * u.scale);
                    o[1] = (o[1] - t.height) / u.scale
                }
                o[0] = parseFloat(o[0]).toFixed(4);
                o[1] = parseFloat(o[1]).toFixed(4);
                if (u.options.editMode) delete r.href;
                delete r.width;
                delete r.height;
                var f = u.R.image(t.attrs.src, o[0], o[1], i, s).attr(r).data(t);
                f.mapsvg_type = "mark";
                if (t.id) f.node.id = t.id;
                if (!u.options.editMode) {
                    if (!l) {
                        f.mousedown(function (e) {
                            if (this.data("popover")) {
                                a.showPopover(e, this.data("popover"))
                            }
                            if (u.options.onClick) return u.options.onClick.call(this, e, a)
                        });
                        if (u.options.mouseOver) {
                            f.mouseover(function (e) {
                                return u.options.mouseOver.call(this, e, a)
                            })
                        }
                        if (u.options.mouseOut) {
                            f.mouseout(function (e) {
                                return u.options.mouseOver.call(this, e, a)
                            })
                        }
                    } else {
                        f.touchstart(function (e) {
                            if (this.attrs.href) {
                                window.location.href = this.attrs.href
                            } else if (this.data("popover")) {
                                a.showPopover(e, this.data("popover"))
                            }
                            if (u.options.onClick) return u.options.onClick.call(this, e, a)
                        })
                    }
                }
                a.markEventHandlersSet(u.options.editMode, f);
                u.RMarks.push(f);
                if (n) u.options.marksEditHandler.call(f);
                else a.markAdjustPosition(f);
                return f
            },
            marksAdjustPosition: function (e) {
                if (!e && (!u.RMarks || u.RMarks.length < 1)) return false;
                var t, n;
                for (var r in u.RMarks.items) {
                    var i = u.RMarks.items[r].data("width");
                    var s = u.RMarks.items[r].data("height");
                    t = i / 2 - i / (2 * u.scale);
                    n = s - s / u.scale;
                    if (c.ie) {
                        i = parseInt(i);
                        s = parseInt(s)
                    }
                    u.RMarks.items[r].attr({
                        width: i / u.scale,
                        height: s / u.scale
                    }).transform("t" + t + "," + n)
                }
            },
            markAdjustPosition: function (e) {
                var t = e.data("width");
                var n = e.data("height");
                var r = t / 2 - t / (2 * u.scale);
                var i = n - n / u.scale;
                e.attr({
                    width: t / u.scale,
                    height: n / u.scale
                }).transform("t" + r + "," + i)
            },
            markGetDefaultCoords: function (e, t, n, r, i) {
                e = parseFloat(e);
                t = parseFloat(t);
                n = parseFloat(n);
                r = parseFloat(r);
                e = parseFloat(e + n / (2 * i) - n / 2).toFixed(2);
                t = parseFloat(t + r / i - r).toFixed(2);
                return [e, t]
            },
            markMoveStart: function () {
                this.data("ox", parseFloat(this.attr("x")));
                this.data("oy", parseFloat(this.attr("y")))
            },
            markMove: function (e, t) {
                e = e / u.scale;
                t = t / u.scale;
                this.attr({
                    x: this.data("ox") + e,
                    y: this.data("oy") + t
                })
            },
            markMoveEnd: function () {
                if (this.data("ox") == this.attr("x") && this.data("oy") == this.attr("y")) {
                    o.marksEditHandler.call(this)
                }
            },
            panStart: function (t) {
                if (t.target.id == "btnZoomIn" || t.target.id == "btnZoomOut") return false;
                t.preventDefault();
                var n = t.touches && t.touches[0] ? t.touches[0] : t;
                u.pan = {};
                u.pan.vxi = u.viewBox[0];
                u.pan.vyi = u.viewBox[1];
                u.pan.x = n.clientX;
                u.pan.y = n.clientY;
                u.pan.dx = 0;
                u.pan.dy = 0;
                u.pan.vx = 0;
                u.pan.vy = 0;
                if (!l) e("body").on("mousemove", a.panMove).on("mouseup", a.panEnd)
            },
            panMove: function (t) {
                t.preventDefault();
                u.isPanning = true;
                u.RMap.attr({
                    cursor: "move"
                });
                e("body").css({
                    cursor: "move"
                });
                var n = t.touches && t.touches[0] ? t.touches[0] : t;
                u.pan.dx = u.pan.x - n.clientX;
                u.pan.dy = u.pan.y - n.clientY;
                var r = parseInt(u.pan.vxi + u.pan.dx / u.scale);
                var i = parseInt(u.pan.vyi + u.pan.dy / u.scale);
                if (u.options.panLimit) {
                    if (r < u.svgDefault.viewBox[0]) r = u.svgDefault.viewBox[0];
                    else if (u.viewBox[2] + r > u.svgDefault.viewBox[2]) r = u.svgDefault.viewBox[2] - u.viewBox[2];
                    if (i < u.svgDefault.viewBox[1]) i = u.svgDefault.viewBox[1];
                    else if (u.viewBox[3] + i > u.svgDefault.viewBox[3]) i = u.svgDefault.viewBox[3] - u.viewBox[3]
                }
                u.pan.vx = r;
                u.pan.vy = i;
                a.setViewBox([u.pan.vx, u.pan.vy, u.viewBox[2], u.viewBox[3]])
            },
            panEnd: function (t) {
                u.isPanning = false;
                if (u.region_clicked && Math.abs(u.pan.dx) < 5 && Math.abs(u.pan.dy) < 5) a.regionClickHandler(t, u.region_clicked);
                e("body").css({
                    cursor: "default"
                });
                u.RMap.attr({
                    cursor: u.options.cursor
                });
                u.viewBox[0] = u.pan.vx || u.viewBox[0];
                u.viewBox[1] = u.pan.vy || u.viewBox[1];
                if (!l) e("body").off("mousemove", a.panMove).off("mouseup", a.panEnd)
            },
            panRegionClickHandler: function (e, t) {
                u.region_clicked = t
            },
            touchStart: function (e) {
                e.preventDefault();
                if (u.options.zoom && e.touches && e.touches.length == 2) {
                    u.touchZoomStartViewBox = u.viewBox;
                    u.touchZoomStart = u.scale;
                    u.touchZoomEnd = 1
                } else {
                    a.panStart(e);
                    u.isPanning = true
                }
            },
            touchMove: function (e) {
                e.preventDefault();
                if (u.options.zoom && e.touches && e.touches.length >= 2) {
                    a.zoom(null, e.scale);
                    u.isPanning = false
                } else if (u.isPanning) {
                    a.panMove(e)
                }
            },
            touchEnd: function (e) {
                e.preventDefault();
                if (u.touchZoomStart) {
                    u.touchZoomStart = false;
                    u.touchZoomEnd = false
                } else if (u.isPanning) {
                    a.panEnd(e)
                }
            },
            marksHide: function () {
                u.RMarks.hide()
            },
            marksShow: function () {
                u.RMarks.show()
            },
            marksGet: function () {
                var t = [];
                e.each(u.RMarks, function (n, r) {
                    if (r.attrs) {
                        var i = e.extend({}, r.attrs);
                        if (!r.data("placed")) {
                            var s = a.markGetDefaultCoords(r.attrs.x, r.attrs.y, r.data("width"), r.data("height"), u.scale);
                            i.x = s[0];
                            i.y = s[1]
                        }
                        if (r.data("href")) i.href = r.data("href");
                        t.push({
                            attrs: i,
                            tooltip: r.data("tooltip"),
                            popover: r.data("popover"),
                            width: r.data("width"),
                            height: r.data("height"),
                            href: r.data("href"),
                            placed: true
                        })
                    }
                });
                return t
            },
            getSelected: function () {
                return u.selected_id
		
            },
            selectRegion: function (t) {
		
                if (!u.ref[t] || u.ref[t].disabled) return false;
                if (u.options.multiSelect) {
			//	alert("multiselect"+u.options.multiSelect)
				
                    var n = e.inArray(t, u.selected_id);
			//		alert("var n"+n);
                    if (n >= 0) {
					alert("var n was >0");
                        u.ref[t].attr({
                            fill: u.ref[t].default_attr.fill
                        });
                        u.selected_id.splice(n, 1);
                        return
                    } else {
			
                        u.selected_id.push(t)
                    }
                } else {
			

                    if (u.selected_id) {
					
                        u.ref[u.selected_id].attr(u.ref[u.selected_id].default_attr);
                        if (c.ie && !c.ie.old) a.mapAdjustStrokes() 
		
                    }
                    u.selected_id = t
                }
                u.ref[t].attr(u.ref[t].selected_attr)
            },
            unhighlightRegion: function (t) {

                if (u.ref[t].disabled || u.options.multiSelect && e.inArray(t, u.selected_id) >= 0 || u.selected_id == t) return false;
                u.ref[t].attr({
				
                    fill: u.ref[t].default_attr.fill
                })
            },
            highlightRegion: function (t) {
       
			if (u.isPanning || u.ref[t].disabled || u.options.multiSelect && e.inArray(t, u.selected_id) >= 0 || u.selected_id == t) return false;
                u.ref[t].attr(u.ref[t].hover_attr)
            },
            ll2px: function (e) {
                var t = e.c;
                var n = parseFloat(t[0]);
                var r = parseFloat(t[1]);
                var i = 2;
                var s = p[i];
                var o = 1;
                var u = Math.round(s + r * d[i]);
                var a = Math.sin(n * 3.14159 / 180);
                if (a < -.9999) a = -.9999;
                else if (a > .9999) a = .9999;
                var f = Math.round(s + .5 * Math.log((1 + a) / (1 - a)) * -v[i]);
                var l = [u - (33.8 + e.width / 2), f - (141.7 + e.height)];
                return l
            },
            isRegionDisabled: function (e, t) {
                if (u.options.regions[e] && (u.options.regions[e].disabled || t == "none")) {
                    return true
                } else if (u.options.disableAll || t == "none" || e == "labels" || e == "Labels") {
                    return true
                } else {
                    return false
                }
            },
            regionClickHandler: function (e, t) {
                if (!t) return false;
                u.region_clicked = null;
                a.selectRegion(t.name);
				alert(t.name);
var states = ["AK","AL","AR","AZ","CA","CO","CT","DC","DE","FL","GA","HI","IA","ID","IL","IN","KS","KY","LA","MA","MD","ME","MI","MN","MO","MS","MT","NC","ND","NE","NH","NJ","NM","NV","NY","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VA","VT","WA","WI","WV","WY"];
if($.inArray(t.name, states) > -1) { 
alert("this is states" + $('#mapdatastates').val());
var newElem = {
    'state' : t.name
   // 'listObjectDesc' : 'Desc 1'
};

if($.inArray(newElem, listObjectsstate) == -1) { 
//var stringData = JSON.stringify(newElem);
var stringData = JSON.stringify(newElem);
listObjectsstate.push(stringData);
}
var cur_spotstate = $('#mapdatastates').val();
if(cur_spotstate)
  $("#mapdatastates").val(cur_spotstate + "," + listObjectsstate);
else
  $("#mapdatastates").val(listObjectsstate);
  
// Update last known state div flag
//jQuery.removeData( div, "lastknownstate" );
$("#lastknownstate").val(t.name);
//alert("after cleanse of div" + $('#lastknownstate').val());
} else {

var newElem = {
    'state' :   $('#lastknownstate').val(),
    'county' : t.name
   // 'listObjectDesc' : 'Desc 1's
};
if($.inArray(newElem, listObjectscounty) == -1) { 
alert("this is county" + $('#mapdatacounty').val());
//var stringData = JSON.stringify(newElem);
var stringData = JSON.stringify(newElem);
listObjectscounty.push(stringData);
}
var cur_spotcounty = $('#mapdatacounty').val();
if(cur_spotcounty)
  $("#mapdatacounty").val(cur_spotcounty + "," + listObjectscounty);
else
  $("#mapdatacounty").val(listObjectscounty);
  
}

// Add this if you want to reset the DIV and only use one vs. multiple
// $( "#test" ).empty();
$("<div id=\"location\"></div>").html('<div class="location" data='+escape(listObjectsstate)+'>'+listObjectsstate+'</div>').appendTo("#maybe");
//$("<div id=\"location\"></div>").html('<div class="location" data='+escape(listObjectscounty)+'>'+listObjectscounty+'</div>').appendTo("#location");
//$("<input>").html('<input value='+hiddenElement.escape(listObjects)+'>').appendTo("#mainsearchform");
//$('#mapdata').append('value='+listObjects);


	

                a.hidePopover();
                if (t.popover) a.showPopover(e, t.popover);
                if (u.options.onClick) return u.options.onClick.call(t, e, a);
                if (l && t.attrs.href) window.location.href = t.attrs.href
            },
            renderSVGPath: function (t, n, r) {
                var i = u.R.path(e(t).attr("d"));
                var s = a.initRaphaelObject(i, t, n, r);
				a.regionAdd(s)
			//	alert(a.regionAdd);
            },
            renderSVGImage: function (t, n, r) {
                var i = e(t).attr("xlink:href"),
                    s = e(t).attr("x") || 0,
                    o = e(t).attr("y") || 0,
                    f = e(t).attr("width") || 0,
                    l = e(t).attr("height") || 0;
                if (!a.fileExists(i)) return false;
                var c = u.R.image(i, s, o, f, l);
                a.initRaphaelObject(c, t, n, r);
                return c
            },
            renderSVGPolygon: function (e, t, n) {
                var r = e.attr("points").trim().replace(/ +(?= )/g, "").split(/\s+|,/);
                var i = r.shift(),
                    s = r.shift();
                var o = "M" + i + "," + s + " L" + r.join(" ") + "z";
                var f = a.initRaphaelObject(u.R.path(o), e, t, n);
                a.regionAdd(f);
                return f
            },
            renderSVGPolyline: function (e, t, n) {
                var r = e.attr("points").trim().replace(/ +(?= )/g, "").split(/\s+|,/);
                var i = r.shift(),
                    s = r.shift();
                var o = "M" + i + "," + s + " L" + r.join(" ");
                var f = a.initRaphaelObject(u.R.path(o), e, t, n);
                return f
            },
            renderSVGCircle: function (t, n, i) {
                var s = e(t).attr("cx") || 0,
                    o = e(t).attr("cy") || 0;
                r = e(t).attr("r") || 0;
                var f = a.initRaphaelObject(u.R.circle(s, o, r), t, n, i);
                a.regionAdd(f);
                return f
            },
            renderSVGEllipse: function (t, n, r) {
                var i = e(t).attr("cx") || 0,
                    s = e(t).attr("cy") || 0;
                rx = e(t).attr("rx") || 0;
                ry = e(t).attr("ry") || 0;
                var o = a.initRaphaelObject(u.R.ellipse(i, s, rx, ry), t, n, r);
                a.regionAdd(o);
                return o
            },
            renderSVGRect: function (t, n, i) {
                var s = e(t).attr("x") || 0,
                    o = e(t).attr("y") || 0,
                    f = e(t).attr("width") || 0,
                    l = e(t).attr("height") || 0;
                r = e(t).attr("rx") || e(t).attr("ry") || 0;
                var c = a.initRaphaelObject(u.R.rect(s, o, f, l, r), t, n, i);
                a.regionAdd(c);
                return c
            },
            renderSVGText: function (t) {
                var n = e(t).find("tspan");
                var r = parseFloat(e(t).attr("x")) || 0;
                var i = parseFloat(e(t).attr("y")) || 0;
                n.each(function (n, s) {
                    var o = a.renderSVGTspan(e(s), {
                        x: r,
                        y: i
                    });
                    o.attr(a.styleSVG2Raphael(t));
                    o.attr(a.styleSVG2Raphael(e(s)));
                    o.transform(a.transformSVG2Raphael(t));
                    o.transform(a.transformSVG2Raphael(e(s)))
                });
                if (n.length == 0) {
                    var s = a.renderSVGTspan(t);
                    s.attr(a.styleSVG2Raphael(t));
                    s.transform(a.transformSVG2Raphael(t))
                }
                return s
            },
            renderSVGTspan: function (t, n) {
                n = n || {
                    x: 0,
                    y: 0
                };
                var r = parseFloat(e(t).attr("x")) || n.x;
                var i = parseFloat(e(t).attr("y")) || n.y;
                if (e(t).attr("dx")) r += n.x + e(t).attr("dx");
                if (e(t).attr("dy")) i += n.y + e(t).attr("dy");
                text = e(t).text();
                var s = u.R.text(r, i, text).attr({
                    "text-anchor": "start"
                });
                s.mapsvg_type = "text";
                e(s.node).css({
                    "-webkit-touch-callout": "none",
                    "-webkit-user-select": "none",
                    "pointer-events": "none"
                });
                return s
            },
            initRaphaelObject: function (t, n, r, s) {
                var o = s || {};
                var u = r || "";
                t.id = e(n).attr("id") || t.type + i++;
                t.node.id = t.id;
                t.name = t.id;
                var f = a.styleSVG2Raphael(n, s);
                t.attr(f);
                var l = a.transformSVG2Raphael(n) + u;
                t.transform(l);
                return t
            },
            styleSVG2Raphael: function (t, n) {
                var n = n || {};
                var r = {};
                var i = e(t).get(0).attributes;
                var s = ["fill", "fill-opacity", "opacity", "font", "font-name", "font-family", "font-size", "font-weight", "stroke", "stroke-lincap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke-width"];
                if (e(t).attr("style")) {
                    var o = e(t).attr("style").split(";");
                    e.each(o, function (e, t) {
                        var n = t.split(":");
                        n[0] = n[0].trim();
                        if (n[1]) n[1] = n[1].trim();
                        if (n[0] == "font-size") n[1] = parseInt(n[1].replace("px", ""));
                        if (a.isNumber(n[0])) n[1] = parseFloat(n[1]);
                        r[n[0]] = n[1]
                    })
                }
                if (i) e.each(i, function (t, n) {
                    if (e.inArray(n.name, s) > -1) {
                        if (n.name == "font-size") {
						
                            n.value = parseInt(n.value.replace("px", ""))
                        }
                        r[n.name] = n.value
                    }
                });
                if (r["font-size"]) {
                    r["font-size"] = parseInt(r["font-size"])
                }
                var u = e.extend({}, n, r);
                if (u["stroke"] == undefined && u["fill"] == undefined) {
                    u["stroke"] = "none";
                    u["fill"] = "#000000"
                } else if (u["stroke"] == undefined) {
                    u["stroke"] = "none"
                } else if (u["fill"] == undefined) {
                    u["fill"] = "none"
                }
                return u
            },
            transformSVG2Raphael: function (n) {
                var r = e(n).attr("transform");
                if (r) {
                    var i = r.split(")");
                    var s = [];
                    for (t in i) {
                        if (i[t] != "") {
                            var o = i[t].split("(");
                            if (o[0] != "matrix") {
                                o[0] = o[0].slice(0, 1).toLowerCase();
                                s.push(o[0] + o[1])
                            } else {
                                m = o[1].split(",");
                                var u = Raphael.matrix(parseFloat(m[0]), parseFloat(m[1]), parseFloat(m[2]), parseFloat(m[3]), parseFloat(m[4]), parseFloat(m[5])).toTransformString();
                                s.push(u)
                            }
                        }
                    }
                    return s.join()
                }
                return ""
            },
            getElementStyles: function (t) {
                if (!c.ie) {
                    return t.style
                } else {
                    var n = {};
                    n.getPropertyValue = function (e) {
                        return n[e] || undefined
                    };
                    if (e(t).attr("style")) {
                        var r = e(t).attr("style").split(";");
                        e.each(r, function (e, t) {
                            var r = t.split(":");
                            n[r[0]] = r[1]
                        })
                    }
                    return n
                }
            },
            fileExists: function (e) {
                if (e.substr(0, 4) == "data") return true;
                var t = new XMLHttpRequest;
                t.open("HEAD", e, false);
                t.send();
                return t.status != 404
            },
            regionAdd: function (t) {
                var n = t.name;
                u.ref[n] = t;
                u.ref[n].disabled = a.isRegionDisabled(n, t.attr("fill"));
                u.ref[n].default_attr = {};
                u.ref[n].default_attr["fill"] = t.attr("fill") || "none";
                if (u.ref[n].default_attr["fill"] && u.ref[n].default_attr["fill"] != "none" && u.options.colors.base) u.ref[n].default_attr["fill"] = u.options.colors.base;
                if (t.attr("stroke")) u.ref[n].default_attr["stroke"] = t.attr("stroke");
                if (t.attr("stroke-width")) u.ref[n].default_attr["stroke-width"] = parseFloat(t.attr("stroke-width"));
                if (u.ref[n].default_attr["stroke"] && u.ref[n].default_attr["stroke"] != "none" && u.options.colors.stroke) u.ref[n].default_attr["stroke"] = u.options.colors.stroke;
                if (u.ref[n].default_attr["stroke-width"] && u.options.strokeWidth) u.ref[n].default_attr["stroke-width"] = parseFloat(u.options.strokeWidth);
                u.ref[n].selected_attr = {};
                u.ref[n].hover_attr = {};
                if (u.ref[n].disabled) {
                    u.ref[n].default_attr.cursor = "default";
                    e(u.ref[n].node).css({
                        "pointer-events": "none"
                    })
                } else {
                    u.ref[n].default_attr.cursor = u.options.cursor
                } if (u.options.regions[n]) {
                    if (u.options.regions[n].attr) u.ref[n].default_attr = e.extend(true, {}, u.ref[n].default_attr, u.options.regions[n].attr);
                    if (u.options.regions[n].tooltip) u.ref[n].tooltip = u.options.regions[n].tooltip;
                    if (u.options.regions[n].popover) u.ref[n].popover = u.options.regions[n].popover;
                    if (u.options.regions[n].data) u.ref[n].data(o.regions[n].data)
                }
                if (a.isNumber(u.options.colors.selected)) u.ref[n].selected_attr["fill"] = a.lighten(u.ref[n].default_attr.fill, parseFloat(u.options.colors.selected));
                else u.ref[n].selected_attr["fill"] = u.options.colors.selected; if (a.isNumber(u.options.colors.hover)) u.ref[n].hover_attr["fill"] = a.lighten(u.ref[n].default_attr.fill, parseFloat(u.options.colors.hover));
                else u.ref[n].hover_attr["fill"] = u.options.colors.hover;
                var r = t.attr("stroke-dasharray");
                if (r && r != "none") u.ref[n].default_attr["stroke-dasharray"] = "--";
                u.ref[n].attr(u.ref[n].default_attr);
                if (!c.ie && !c.firefox) e(u.ref[n].node).css({
                    "vector-effect": "non-scaling-stroke"
                });
                u.RMap.push(u.ref[n]);
                if (u.options.regions[n] && u.options.regions[n].selected) a.selectRegion(n)
            },
            lighten2: function (e, t) {
                var n = e.charAt(0) == "#" ? e.substring(1, 7) : e;
                var r = Raphael.rgb2hsb(parseInt(n.substring(0, 2), 16), parseInt(n.substring(2, 4), 16), parseInt(n.substring(4, 6), 16));
                r.b += .1;
                return Raphael.hsb(r)
            },
            lighten: function (e, t) {
                if (!e) return false;
                t = parseInt(t) * .008;
                var n = Raphael.getRGB(e);
                var r = Raphael.rgb2hsb(n.r, n.g, n.b);
                var i = r.b + t;
                if (i >= 1) {
                    i = 1;
                    r.s = r.s - t * 1.5
                } else if (i <= 0) {
                    i = 0
                }
                var s = Raphael.hsb2rgb(r.h, r.s, i);
                return s.hex
            },
            setPan: function (e) {
                if (e) {
                    u.options.pan = true;
                    u.$map.on("mousedown", a.panStart)
                } else {
                    if (u.options.pan) u.$map.off("mousedown", a.panStart);
                    u.options.pan = false
                }
            },
            markAddClickHandler: function (t) {
                if (e(t.target).is("image")) return false;
                var n = t.offsetX == undefined ? t.layerX : t.offsetX;
                var r = t.offsetY == undefined ? t.layerY : t.offsetY;
                a.markAdd({
                    xy: [n, r]
                }, true)
            },
            markEventHandlersSet: function (e, t) {
                e = a.parseBoolean(e);
                if (e) {
                    if (u.options.editMode === false) t.unhover();
                    t.drag(a.markMove, a.markMoveStart, a.markMoveEnd)
                } else {
                    if (u.options.editMode) t.undrag();
                    t.hover(function () {
                        if (this.data("tooltip")) {
					
                            u.mapTip.html(this.data("tooltip"));
                            u.mapTip.show()
                        }
                    }, function () {
                        if (this.data("tooltip")) u.mapTip.hide()
                    })
                }
            },
            setMarksEditMode: function (e, t) {
                e = a.parseBoolean(e);
                if (e) {
                    u.$map.on("click", a.markAddClickHandler)
                } else {
                    u.$map.off("click", a.markAddClickHandler)
                }
                u.options.editMode = e
            },
            setZoom: function (t) {
                if (t) {
                    u.options.zoom = true;
                    u.$map.bind("mousewheel.mapsvg", function (e, t, n, r) {
                        var i = t > 0 ? 1 : -1;
                        a.zoom(i);
                        return false
                    });
                    if (u.options.zoomButtons.show) {
                        var n = e("<div></div>");
                        var r = {
                            "border-radius": "3px",
                            display: "block",
                            "margin-bottom": "7px"
                        };
                        var i = e('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABhElEQVR4nJWTT4rqQBDGf92pSEJWmYfgQpABb+EB1NU8DyBe5M1q5iKStTCDd/AWggElC3EQJAQxbb/NJDH+mccraEh31fdVfR8pBRBF0Uuapn+AX8CZn0MDuyAI3sfj8aeaTqcvWZZ9XFdZazmdTgC4rotS6oYpCILfkmXZ6yNwt9tFKcVyucRxnBuSNE1fNfB0TWCModlsMhwOGQwGdDod8jy/J+dJP9JsjKl9W2vvlZ3lcuyiS57ntY7FvZDgum6Zk0vN7XYbay3GGMIwLItarRbGGEQErTVxHON5XkVQAEaj0b0x6fV6tXsURRwOBxzHQd9F/CPO58o2ARARdrsds9ms9CIMQ/r9PgCLxYL1eo3rulhr2e/3dQkAnueRJElp2vF4LLskScJmsynNK8A1AqjcVUohUqVEBBGpuV+E/j63CV093/sLizIBvoDny1fHcdhut8znc5RSrFar2kQX8aV933+7ZldK0Wg0iOO4BD9YpjcF8L2R/7XOvu+/TyaTz79+UqnWsVHWHAAAAABJRU5ErkJggg==" id="btnZoomIn"/>').on("click", function (e) {
                            e.stopPropagation();
                            a.zoomIn()
                        }).css(r);
                        var s = e('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA6klEQVR4nKWTPW6DQBBG3w4RaLXSFs4puAe9fQHEReLKPgYN4gLxQei5RNytFraANNEKKwk29uum+N78SKMA2rbdO+c+gHdgYh0Bvowx57IsL6ppmr33/vNO6E+MMQfx3h+fCQM4544C7J4VADvh/s5rTG/LKoTANK37RIQ0TWMdBSEE8jwnyzLmef437L2n7/soiQLnHEVRPDR313VRIA8lVogTWGup6/pmhSRJAFBKxcAwDFhrfwuSJCGEwDiOqx2VUlF8I1h23ILw2h1EgOsLgqtorU/LI23BGHNSAD8fuemdtdbnqqou39SbTK6RdYDsAAAAAElFTkSuQmCC" id="btnZoomOut"/>').on("click", function (e) {
                            e.stopPropagation();
                            a.zoomOut()
                        }).css(r);
                        n.append(s).append(i).css({
                            position: "absolute",
                            top: "15px",
                            width: "16px",
                            cursor: "pointer"
                        });
                        if (u.options.zoomButtons.location == "right") n.css({
                            right: "15px"
                        });
                        else if (u.options.zoomButtons.location == "left") n.css({
                            left: "15px"
                        });
                        u.zoomButtons = n;
                        u.$map.append(u.zoomButtons)
                    }
                } else {
                    if (u.options.zoom) u.$map.unbind("mousewheel.mapsvg");
                    if (u.zoomButtons) u.zoomButtons.hide();
                    u.options.zoom = false
                }
            },
            setSize: function (t, n, r) {
                u.options.width = parseInt(t);
                u.options.height = parseInt(n);
                u.options.responsive = a.parseBoolean(r);
                if (!u.options.width && !u.options.height) {
                    u.options.width = u.svgDefault.width;
                    u.options.height = u.svgDefault.height
                } else if (!u.options.width && u.options.height) {
                    u.options.width = parseInt(u.options.height * u.svgDefault.width / u.svgDefault.height)
                } else if (u.options.width && !u.options.height) {
                    u.options.height = parseInt(u.options.width * u.svgDefault.height / u.svgDefault.width)
                }
                if (u.options.responsive) {
                    var i = u.options.width;
                    var s = u.options.height;
                    u.options.width = u.svgDefault.width;
                    u.options.height = u.svgDefault.height
                }
                u.whRatio = u.options.width / u.options.height;
                u.scale = a.getScale();
                if (u.options.responsive) {
                    u.$map.css({
                        "max-width": i + "px",
                        "max-height": s + "px",
                        width: "auto",
                        height: "auto",
                        position: "relative"
                    }).height(u.$map.width() / u.whRatio);
                    e(window).bind("resize.mapsvg", function () {
                        u.$map.height(u.$map.width() / u.whRatio)
                    })
                } else {
                    u.$map.css({
                        width: u.options.width + "px",
                        height: u.options.height + "px",
                        "max-width": "none",
                        "max-height": "none",
                        position: "relative"
                    });
                    e(window).unbind("resize.mapsvg")
                } if (!u.options.responsive && u.R) u.R.setSize(u.options.width, u.options.height);
                return [u.options.width, u.options.height]
            },
            setMarks: function (t) {
                if (t) {
                    e.each(t, function (e, t) {
                        a.markAdd(t)
                    })
                }
            },
            showTip: function () {},
            showPopover: function () {},
            hideTip: function () {
                u.mapTip.hide();
                u.mapTip.html("")
            },
            setTooltip: function (t) {
                u.mapTip = e('<div class="map_tooltip"></div>');
                e('.map_modal').append(u.mapTip);
                u.mapTip.css({
                    "font-weight": "normal",
                    "font-size": "12px",
                    color: "#000000",
                    position: "absolute",
                    "border-radius": "4px",
                    "-moz-border-radius": "4px",
                    "-webkit-border-radius": "4px",
                    top: "0",
                    left: "0",
                    "z-index": "1000",
                    display: "none",
                    "background-color": "white",
                    border: "1px solid #eee",
                    padding: "4px 7px",
                    "max-width": "600px"
                });
                if (u.options.tooltips.show == "hover") {
                    u.$map.mousemove(function (t) {
                        u.mapTip.css("left", t.clientX + e(window).scrollLeft()).css("top", t.clientY + e(window).scrollTop() + 30)
                    })
                }
                a.showTip = u.options.tooltipsMode == "custom" ? function (e) {
                    if (u.ref[e].tooltip) {
                        u.mapTip.html(u.ref[e].tooltip);
                        u.mapTip.show()
                    }
                } : u.options.tooltipsMode == "names" ? function (e) {
                    if (u.ref[e].disabled) return false;
                    u.mapTip.html(e.replace(/_/g, " "));
                    u.mapTip.show()
                } : u.options.tooltipsMode == "combined" ? function (e) {
                    if (u.ref[e].tooltip) {
                        u.mapTip.html(u.ref[e].tooltip);
                        u.mapTip.show()
                    } else {
                        if (u.ref[e].disabled) return false;
                        u.mapTip.html(e.replace(/_/g, " "));
                        u.mapTip.show()
                    }
                } : function (e) {
                    null
                }
            },
            setPopover: function (t) {
                if (!t) return false;
                e('.map_modal').prepend('<div class="map_popover"><div class="map_popover_content"></div><div class="map_popover_close">x</div></div>');
                u.mapPopover = e(".map_popover");
                var n = u.mapPopover.find(".map_popover_close");
                u.mapPopover.css({
                    "font-weight": "normal",
                    "font-size": "12px",
                    color: "#000000",
                    position: "absolute",
                    "border-radius": "4px",
                    "-moz-border-radius": "4px",
                    "-webkit-border-radius": "4px",
                    top: "0",
                    left: "0",
                    "z-index": "1000",
                    width: u.options.popover.width + (u.options.popover.width == "auto" ? "" : "px"),
                    height: u.options.popover.height + (u.options.popover.height == "auto" ? "" : "px"),
                    display: "none",
                    "background-color": "white",
                    border: "1px solid #ccc",
                    padding: "12px",
                    "-webkit-box-shadow": "5px 5px 5px 0px rgba(0, 0, 0, 0.2)",
                    "box-shadow": "5px 5px 5px 0px rgba(0, 0, 0, 0.2)"
                });
                n.css({
                    position: "absolute",
                    top: "0",
                    right: "5px",
                    cursor: "pointer",
                    color: "#aaa",
                    "z-index": "1200"
                });
                a.showPopover = function (t, n, r) {
                    if (!r || r.length != 2) {
                        var i = h(t);
                        var r = [i.x, i.y]
                    }
                    if (n) {
                        u.mapPopover.find(".map_popover_content").html(n);
                        var s = r[0] - u.mapPopover.outerWidth(false) / 2;
                        var o = r[1] - u.mapPopover.outerHeight(false) - 7;
                        if (s < 0) s = 0;
                        if (o < 0) o = 0;
                        if (s + u.mapPopover.outerWidth(false) > e(window).scrollLeft() + e(window).width()) s = e(window).scrollLeft() + e(window).width() - u.mapPopover.outerWidth(false);
                        if (o + u.mapPopover.outerHeight(false) > e(window).scrollTop() + e(window).height()) o = e(window).scrollTop() + e(window).height() - u.mapPopover.outerHeight(false);
                        if (s < e(window).scrollLeft()) s = e(window).scrollLeft();
                        if (o < e(window).scrollTop()) o = e(window).scrollTop();
                        u.mapPopover.css("left", s).css("top", o);
                        u.mapPopover.show()
                    }
                };
                a.hidePopover = function () {
                    u.mapPopover.find(".map_popover_content").html("");
                    u.mapPopover.hide()
                };
                n.on("click", a.hidePopover)
            },
            popoverOffHandler: function (t) {
                if (!e(t.target).closest("#map_popover").length) a.hidePopover()
            },
            isNumber: function (e) {
                return !isNaN(parseFloat(e)) && isFinite(e)
            },
            parseBoolean: function (e) {
                switch (String(e).toLowerCase()) {
                case "true":
                case "1":
                case "yes":
                case "y":
                    return true;
                case "false":
                case "0":
                case "no":
                case "n":
                    return false;
                default:
                    return undefined
                }
            },
            mouseOverHandler: function () {},
            mouseOutHandler: function () {},
            mouseDownHandler: function () {},
            init: function (t, n) {
                if (!t.source) {
                    alert("mapSVG Error: Please provide a map URL");
                    return false
                }
                if (t.source.indexOf("http://") == 0 || t.source.indexOf("https://") == 0) t.source = "//" + t.source.split("://").pop();
                t.pan = a.parseBoolean(t.pan);
                t.zoom = a.parseBoolean(t.zoom);
                t.responsive = a.parseBoolean(t.responsive);
                t.disableAll = a.parseBoolean(t.disableAll);
                t.multiSelect = a.parseBoolean(t.multiSelect);
                if (t.viewBox && typeof t.viewBox == "string") {
                    t.viewBoxFind = t.viewBox;
                    delete t.viewBox
                }
                u = {};
                u.options = e.extend(true, {}, g, t);
                u.map = n;
                u.$map = e(n);
                u.whRatio = 0;
                u.isPanning = false;
                u.markOptions = {};
                u.svgDefault = {};
                u.mouseDownHandler;
                u.ref = {};
                u.refLength = 0;
                u.scale = 1;
                u._scale = 1;
                u.selected_id = u.options.multiSelect ? [] : 0;
                u.mapData = {};
                u.ref = {};
                u.marks = [];
                u._viewBox = [];
                u.viewBox = [];
                u.viewBoxZoom = [];
                u.viewBoxFind = undefined;
                u.zoomLevel = 0;
                u.pan = {};
                u.zoom;
                u.touchZoomStart;
                u.touchZoomStartViewBox;
                u.touchZoomEnd;
                u.$map.css({
                    background: u.options.colors.background,
                    height: "100px",
                    position: "relative"
                });
                var r = e("<div>" + u.options.loadingText + "</div>").css({
                    position: "absolute",
                    top: "50%",
                    left: "50%",
                    "z-index": 1,
                    padding: "7px 10px",
                    "border-radius": "5px",
                    "-webkit-border-radius": "5px",
                    "-moz-border-radius": "5px",
                    "-ms-border-radius": "5px",
                    "-o-border-radius": "5px",
                    border: "1px solid #ccc",
                    background: "#f5f5f2",
                    color: "#999"
                });
                u.$map.append(r);
                r.css({
                    "margin-left": function () {
                        return -(e(this).outerWidth(false) / 2) + "px"
                    },
                    "margin-top": function () {
                        return -(e(this).outerHeight(false) / 2) + "px"
                    }
                });
                e.ajax({
                    url: u.options.source,
                    contentType: "image/svg+xml; charset=utf-8",
                    beforeSend: function (e) {
                        if (e && e.overrideMimeType) {
                            e.overrideMimeType("image/svg+xml; charset=utf-8")
                        }
                    },
                    success: function (t) {
                        $data = e(t);
                        var n = $data.find("svg");
                        u.svgDefault.width = parseFloat(n.attr("width").replace(/px/g, ""));
                        u.svgDefault.height = parseFloat(n.attr("height").replace(/px/g, ""));
                        u.svgDefault.viewBox = n.attr("viewBox") ? n.attr("viewBox").split(" ") : [0, 0, u.svgDefault.width, u.svgDefault.height];
                        e.each(u.svgDefault.viewBox, function (e, t) {
                            u.svgDefault.viewBox[e] = parseInt(t)
                        });
                        u._viewBox = u.options.viewBox.length == 4 ? u.options.viewBox : u.svgDefault.viewBox;
                        e.each(u._viewBox, function (e, t) {
                            u._viewBox[e] = parseInt(t)
                        });
                        a.setSize(u.options.width, u.options.height, u.options.responsive);
                        if (c.ie && c.ie.old) {
                            u.R = Raphael(u.$map.attr("id"), u.options.width, u.options.height);
                            u.scale = a.getScale();
                            if (u.options.responsive) e(window).on("resize", a.fluidResize)
                        } else {
                            u.R = Raphael(u.$map.attr("id"), "100%", "100%");
                            if (u.options.responsive) {
                                e(window).on("resize", function (e) {
                                    u.scale = a.getScale();
                                    a.marksAdjustPosition()
                                })
                            }
                        } if (u.options.panBackground) u.background = u.R.rect(u.svgDefault.viewBox[0], u.svgDefault.viewBox[1], u.svgDefault.viewBox[2], u.svgDefault.viewBox[3]).attr({
                            fill: u.options.colors.background
                        });
                        u.RMap = u.R.set();
                        u.RMarks = u.R.set();
                        var i = function (t, n, r) {
                            var i = e(t).get(0).tagName;
                            switch (i) {
                            case "path":
                                a.renderSVGPath(t, n, r);
                                break;
                            case "polygon":
                                a.renderSVGPolygon(t, n, r);
                                break;
                            case "polyline":
                                a.renderSVGPolyline(t, n, r);
                                break;
                            case "circle":
                                a.renderSVGCircle(t, n, r);
                                break;
                            case "ellipse":
                                a.renderSVGEllipse(t, n, r);
                                break;
                            case "rect":
                                a.renderSVGRect(t, n, r);
                                break;
                            case "image":
                                a.renderSVGImage(t, n, r);
                                break;
                            case "text":
                                a.renderSVGText(t, n, r);
                                break;
                            default:
                                null;
                                break
                            }
                        };
                        var s = function (t, n, r) {
                            var o = e(t).children();
                            if (o.length) {
                                var u = [];
                                n = n || "";
                                n = a.transformSVG2Raphael(t) + n;
                                r = r || {};
                                e(t).children().each(function (t, i) {
                                    var o = a.styleSVG2Raphael(i, r);
                                    s(e(i), n, o)
                                })
                            }
                            i(e(t), n, r)
                        };
                        s($data.find("svg"));
                        var f = u.options.viewBoxFind || u._viewBox;
                        a.setViewBox(f);
                        a.setMarks(u.options.marks);
                        a.setMarksEditMode(u.options.editMode);
                        a.setPan(u.options.pan);
                        a.setZoom(u.options.zoom);
                        a.setTooltip(u.options.tooltips.mode);
                        a.setPopover(u.options.popover);
                        if (u.options.responsive && c.ie && c.ie.old) a.fluidResize();
                        if (c.ie && !c.ie.old || c.firefox) a.mapAdjustStrokes();
                        var h = "";
                        if (!l) {
                            h = "methods.highlightRegion(this.name);";
                            if (u.options.tooltips.show == "hover") h += "methods.showTip(this.name);";
                            if (u.options.mouseOver) h += "return options.mouseOver.call(this, e, methods);";
                            a.mouseOverHandler = new Function("e, methods, options", h);
                            h = "";
                            h += "methods.unhighlightRegion(this.name);";
                            if (u.options.tooltips.show == "hover") h += "methods.hideTip();";
                            if (u.options.mouseOut) h += "return options.mouseOut.call(this, e, methods);";
                            a.mouseOutHandler = new Function("e, methods, options", h)
                        }
                        h = "";
                        h = "methods.regionClickHandler.call(mapObj, e, this);";
                        a.mouseDownHandler = new Function("e, methods", h);
                        if (!l) {
                            u.RMap.mouseover(function (e) {
                                a.mouseOverHandler.call(this, e, a, o)
                            }).mouseout(function (e) {
                                a.mouseOutHandler.call(this, e, a, o)
                            })
                        }
                        if (!u.options.pan) {
                            u.RMap.mousedown(function (e) {
                                a.regionClickHandler.call(a, e, this)
                            });
                            u.RMap.touchstart(function (e) {
                                e.preventDefault();
                                a.regionClickHandler.call(a, e, this)
                            })
                        } else {
                            if (!l) {
                                u.RMap.mousedown(function (e) {
                                    e.preventDefault();
                                    a.panRegionClickHandler.call(a, e, this)
                                })
                            } else {
                                u.RMap.touchstart(function (e) {
                                    a.panRegionClickHandler.call(a, e, this)
                                });
                                u.R.canvas.addEventListener("touchstart", function (e) {
                                    a.touchStart(e)
                                }, false);
                                u.R.canvas.addEventListener("touchmove", function (e) {
                                    a.touchMove(e)
                                }, false);
                                u.R.canvas.addEventListener("touchend", function (e) {
                                    a.touchEnd(e)
                                }, false)
                            }
                        }
                        r.hide()
                    }
                });
                return a
            }
        };
        var a = this.methods
    };
    e.fn.mapSvg = function (t) {
        var r = e(this).attr("id");
        if (typeof t == "object" && n[r] === undefined) {
            n[r] = new b(this, t);
            return n[r].methods.init(t, this)
        } else if (n[r]) {
            return n[r].methods
        } else {
            return e(this)
        }
    }
})(jQuery)